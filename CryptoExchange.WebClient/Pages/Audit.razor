@page "/Audit"

<PageTitle>Audit</PageTitle>

@if (_bookTimestamps.Count == 0)
    return;

<div class="d-flex text-center">
    <div class="bg-darkblue border col rounded p-4 text-white">
        <div class="d-flex">
            <select class="form-select col flex-grow-1" @bind="_selectedOrderbookId">
                @foreach (var item in _bookTimestamps)
                {
                    <option value="@item.Key">@item.Value</option>
                }
            </select>
            <div class="">
                <button type="button" class="btn btn-outline-light @DisableIfNotSelected()" @onclick="LoadOrderBook">Load Orderbook</button>
            </div>
        </div>

    </div>
</div>

@if (_orderBook is not null)
{
    <div class="d-flex text-center">
        <div class="bg-darkblue border col rounded p-4 text-white">

            <div class="p-2">
                <h1 class="m-0">Historical Order book BTC EUR</h1>
                <p class="m-0">Last updated: @_orderBook.TimeStamp.ToLocalTime()</p>
            </div>
            <div class="d-flex pt-2">
                <div class="col-6 px-2">
                    <h3 class="px-2">Bids</h3>
                    <div class="border border-black rounded d-flex px-2 text-bg-success">
                        <div class="col">
                            <p class="m-0">Price</p>
                        </div>
                        <div class="col">
                            <p class="m-0">Amount</p>
                        </div>
                    </div>

                    @foreach (var bid in _orderBook.Bids.OrderByDescending(x => x.Price).Take(10))
                    {
                        <div class="d-flex px-2">
                            <div class="col text-success">
                                @bid.Price
                            </div>
                            <div class="col">
                                @bid.Amount
                            </div>
                        </div>
                    }
                </div>
                <div class="col-6 px-2">
                    <h3 class="px-2">Asks</h3>
                    <div class="border border-black rounded d-flex px-2 text-bg-danger">
                        <div class="col">
                            <p class="m-0">Price</p>
                        </div>
                        <div class="col">
                            <p class="m-0">Amount</p>
                        </div>
                    </div>

                    @foreach (var ask in _orderBook.Asks.OrderBy(x => x.Price).Take(10))
                    {
                        <div class="d-flex px-2">
                            <div class="col text-danger">
                                @ask.Price
                            </div>
                            <div class="col">
                                @ask.Amount
                            </div>
                        </div>
                    }

                </div>
            </div>
        </div>
    </div>
    <BarChart @ref="barChart" Class="mb-4" />
}